<Window x:Class="ElectronicObserver.FormMainWpf"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ElectronicObserver"

		x:Name="FormMainWpfControl"

        TextElement.Foreground="White"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="12"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"

        xmlns:ui="http://schemas.modernwpf.com/2019"
        xmlns:viewModels="clr-namespace:ElectronicObserver.ViewModels"
        xmlns:avalonDockTesting="clr-namespace:ElectronicObserver.AvalonDockTesting"
        xmlns:viewModels1="clr-namespace:ElectronicObserver.Window.Wpf.Fleet.ViewModels"
        xmlns:fleet="clr-namespace:ElectronicObserver.Window.Wpf.Fleet"
        xmlns:winformsHost="clr-namespace:ElectronicObserver.Window.Wpf.WinformsHost"
        xmlns:winformsWrappers="clr-namespace:ElectronicObserver.Window.Wpf.WinformsWrappers"
        ui:WindowHelper.UseModernWindowStyle="True"

        mc:Ignorable="d"
        Title="FormMainWpf"
		Height="450"
        Width="800"
>
	<Grid DataContext="{Binding ViewModel, ElementName=FormMainWpfControl}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition />
		</Grid.RowDefinitions>

		<Menu Grid.Row="0">
			<MenuItem Header="File">
				<MenuItem Header="Layout">
					<MenuItem Header="Save" Command="{Binding SaveLayoutCommand}" />
					<MenuItem Header="Load" Command="{Binding LoadLayoutCommand}" />
				</MenuItem>
			</MenuItem>
			<MenuItem Header="View">
				<MenuItem Header="Fleet">
					<MenuItem Header="#1" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormFleets[0]}" />
					<MenuItem Header="#2" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormFleets[1]}" />
					<MenuItem Header="#3" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormFleets[2]}" />
					<MenuItem Header="#4" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormFleets[3]}" />
				</MenuItem>
				<MenuItem Header="Fleet List" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormFleetOverview}" />
				<MenuItem Header="Ship Group" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormShipGroup}" />
				<MenuItem Header="Presets" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormFleetPreset}" />
				<Separator />
				<MenuItem Header="Compass" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormCompass}" />
				<Separator />
				<MenuItem Header="Browser" Command="{Binding OpenViewCommand}" CommandParameter="{Binding FormBrowserHost}" />
			</MenuItem>
			<MenuItem Header="Wpf">
				<MenuItem Header="Fleet">
					<MenuItem Header="#1" Command="{Binding OpenViewCommand}" CommandParameter="{Binding Fleets[0]}" />
					<MenuItem Header="#2" Command="{Binding OpenViewCommand}" CommandParameter="{Binding Fleets[1]}" />
					<MenuItem Header="#3" Command="{Binding OpenViewCommand}" CommandParameter="{Binding Fleets[2]}" />
					<MenuItem Header="#4" Command="{Binding OpenViewCommand}" CommandParameter="{Binding Fleets[3]}" />
				</MenuItem>
				<Separator />
				<MenuItem Header="Log" Command="{Binding OpenViewCommand}" CommandParameter="{Binding LogViewModel}" />
			</MenuItem>
		</Menu>

		<DockingManager
			x:Name="DockingManager"
			Grid.Row="1"
			AnchorablesSource="{Binding Views}"
			AllowMixedOrientation="True"
			IsVirtualizingAnchorable="True"
			IsVirtualizingDocument="True"
			>
			
			<DockingManager.Theme>
				<Vs2013DarkTheme />
			</DockingManager.Theme>

			<DockingManager.DocumentHeaderTemplate>
				<DataTemplate DataType="viewModels:AnchorableViewModel">
					<StackPanel Orientation="Horizontal">
						<Image Source="{Binding IconSource}" Margin="0,0,4,0"/>
						<TextBlock Text="{Binding Title}" />
					</StackPanel>
				</DataTemplate>
			</DockingManager.DocumentHeaderTemplate>

			<DockingManager.LayoutItemTemplateSelector>
				<local:ViewTemplateSelector>
					<local:ViewTemplateSelector.FleetTemplate>
						<DataTemplate DataType="viewModels1:FleetViewModel">
							<fleet:FleetView ViewModel="{Binding}" />
						</DataTemplate>
					</local:ViewTemplateSelector.FleetTemplate>
					<local:ViewTemplateSelector.LogViewTemplate>
						<DataTemplate DataType="avalonDockTesting:LogViewModel">
							<avalonDockTesting:LogView ViewModel="{Binding}" />
						</DataTemplate>
					</local:ViewTemplateSelector.LogViewTemplate>
					<local:ViewTemplateSelector.WinformsHostTemplate>
						<DataTemplate DataType="winformsWrappers:FormBrowserHostViewModel">
							<winformsHost:WinformsHostView ViewModel="{Binding}"/>
						</DataTemplate>
					</local:ViewTemplateSelector.WinformsHostTemplate>
				</local:ViewTemplateSelector>
			</DockingManager.LayoutItemTemplateSelector>

			<DockingManager.LayoutItemContainerStyleSelector>
				<local:ViewStyleSelector>
					<local:ViewStyleSelector.AnchorableStyle>
						<Style TargetType="LayoutAnchorableItem">
							<Setter Property="Title" Value="{Binding Model.Title}" />
							<Setter Property="ContentId" Value="{Binding Model.ContentId}" />
							<Setter Property="IconSource" Value="{Binding Model.IconSource}" />
							<Setter Property="Visibility" Value="{Binding Model.Visibility, Mode=TwoWay}" />
							<Setter Property="IsSelected" Value="{Binding Model.IsSelected, Mode=TwoWay}" />
							<Setter Property="IsActive" Value="{Binding Model.IsActive, Mode=TwoWay}" />
							<Setter Property="CanClose" Value="True" />
							<Setter Property="CanHide" Value="False" />
							<Setter Property="CloseCommand" Value="{Binding Model.CloseCommand}" />
						</Style>
					</local:ViewStyleSelector.AnchorableStyle>
				</local:ViewStyleSelector>
			</DockingManager.LayoutItemContainerStyleSelector>
			
			<LayoutRoot>
				<LayoutPanel>
					<LayoutAnchorablePane AllowDuplicateContent="False" />
				</LayoutPanel>
			</LayoutRoot>

		</DockingManager>
    </Grid>
</Window>
